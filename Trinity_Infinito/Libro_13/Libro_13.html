<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Libro 13: ∞ - El Libro Que Se Escribe Al Ser Observado</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000000;
            color: #ffffff;
            font-family: 'Georgia', serif;
            overflow-x: hidden;
            cursor: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Cursor Cósmico Personalizado */
        .cosmic-cursor {
            position: fixed;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(138, 43, 226, 0.8), transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 10000;
            mix-blend-mode: screen;
            filter: blur(1px);
            transition: transform 0.1s ease-out;
        }
        
        .cursor-trail {
            position: fixed;
            width: 6px;
            height: 6px;
            background: rgba(138, 43, 226, 0.4);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: screen;
            filter: blur(0.5px);
        }
        
        /* El Void Evolucionado */
        #void-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        /* Contenedor Principal Mejorado */
        .universe-container {
            position: relative;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1;
            opacity: 1;
            transition: opacity 2s ease-in-out;
        }
        
        /* Título con Efecto de Entrelazamiento Cuántico */
        .quantum-title {
            font-size: clamp(4rem, 15vw, 14rem);
            margin-bottom: 15vh;
            text-align: center;
            position: relative;
            animation: quantum-superposition 13s infinite;
            text-shadow: 
                0 0 40px rgba(138, 43, 226, 0.8),
                0 0 80px rgba(138, 43, 226, 0.4),
                0 0 120px rgba(138, 43, 226, 0.2);
            background: linear-gradient(135deg, 
                #8a2be2 0%, 
                #ffffff 25%, 
                #8a2be2 50%, 
                #ffffff 75%, 
                #8a2be2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: title-shimmer 8s ease-in-out infinite;
        }
        
        @keyframes quantum-superposition {
            0%, 100% { 
                opacity: 0.3; 
                filter: blur(15px) hue-rotate(0deg);
                transform: scale(0.95) rotate(-1deg);
            }
            25% {
                opacity: 0.7;
                filter: blur(5px) hue-rotate(90deg);
                transform: scale(1.05) rotate(1deg);
            }
            50% { 
                opacity: 1; 
                filter: blur(0px) hue-rotate(180deg);
                transform: scale(1) rotate(0deg);
            }
            75% {
                opacity: 0.7;
                filter: blur(5px) hue-rotate(270deg);
                transform: scale(1.05) rotate(-1deg);
            }
        }
        
        @keyframes title-shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        /* Los 7 Portales Evolucionados */
        .portals {
            width: 100%;
            max-width: min(90vw, 1200px);
            display: flex;
            flex-direction: column;
            gap: 20vh;
            padding: 10vh 5vw;
        }
        
        .portal {
            position: relative;
            min-height: 60vh;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border-radius: 50%;
            overflow: hidden;
        }
        
        .portal::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, 
                rgba(138, 43, 226, 0.1) 0%, 
                transparent 70%);
            opacity: 0;
            transition: opacity 3s ease;
            z-index: -1;
        }
        
        .portal.active::before {
            opacity: 1;
        }
        
        /* Portal 1: El Vacío Cuántico */
        .portal-1 {
            width: min(300px, 40vw);
            height: min(300px, 40vw);
            margin: 0 auto;
            border: 2px solid rgba(255, 255, 255, 0.05);
            animation: quantum-fluctuation 13s infinite;
            background: radial-gradient(circle at 30% 30%, 
                rgba(138, 43, 226, 0.02) 0%, 
                transparent 50%);
        }
        
        @keyframes quantum-fluctuation {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                box-shadow: 
                    inset 0 0 50px rgba(138, 43, 226, 0.05),
                    0 0 100px rgba(138, 43, 226, 0.02);
            }
            33% { 
                transform: scale(0.7) rotate(120deg);
                box-shadow: 
                    inset 0 0 100px rgba(138, 43, 226, 0.1),
                    0 0 200px rgba(138, 43, 226, 0.05);
            }
            66% { 
                transform: scale(1.3) rotate(240deg);
                box-shadow: 
                    inset 0 0 150px rgba(138, 43, 226, 0.08),
                    0 0 300px rgba(138, 43, 226, 0.1);
            }
        }
        
        /* Portal 2: La Línea del Tiempo No-Lineal */
        .portal-2 {
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.8), 
                transparent);
            position: relative;
            animation: timeline-pulse 7s infinite;
        }
        
        .portal-2::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            width: 20px;
            height: 20px;
            background: rgba(138, 43, 226, 0.8);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: timeline-travel 7s infinite;
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.6);
        }
        
        @keyframes timeline-pulse {
            0%, 100% { transform: scaleX(0); opacity: 0.3; }
            50% { transform: scaleX(1); opacity: 1; }
        }
        
        @keyframes timeline-travel {
            0% { left: 0%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { left: 100%; opacity: 0; }
        }
        
        /* Portal 3: Los Puntos de Singularidad */
        .portal-3 {
            font-size: clamp(2rem, 8vw, 6rem);
            letter-spacing: 2rem;
            opacity: 0.3;
            animation: singularity-dance 9s infinite;
            position: relative;
        }
        
        .portal-3 span {
            display: inline-block;
            animation: point-orbit 3s infinite;
        }
        
        .portal-3 span:nth-child(1) { animation-delay: 0s; }
        .portal-3 span:nth-child(2) { animation-delay: 1s; }
        .portal-3 span:nth-child(3) { animation-delay: 2s; }
        
        @keyframes singularity-dance {
            0%, 100% { 
                opacity: 0.1; 
                filter: blur(10px);
                transform: scale(0.8);
            }
            50% { 
                opacity: 0.9; 
                filter: blur(0);
                transform: scale(1.2);
            }
        }
        
        @keyframes point-orbit {
            0%, 100% { transform: translateY(0) scale(1); }
            25% { transform: translateY(-30px) scale(1.5); }
            50% { transform: translateY(0) scale(1); }
            75% { transform: translateY(30px) scale(0.5); }
        }
        
        /* Portal 4: El OM Holográfico */
        .portal-4 {
            font-size: clamp(6rem, 20vw, 18rem);
            color: rgba(138, 43, 226, 0.3);
            animation: om-hologram 8s infinite;
            text-shadow: 
                0 0 50px rgba(138, 43, 226, 0.5),
                0 0 100px rgba(138, 43, 226, 0.3),
                0 0 200px rgba(138, 43, 226, 0.1);
            position: relative;
        }
        
        .portal-4::before {
            content: 'ॐ';
            position: absolute;
            top: 0;
            left: 0;
            color: rgba(255, 255, 255, 0.1);
            animation: om-echo 4s infinite;
        }
        
        @keyframes om-hologram {
            0%, 100% { 
                transform: scale(1) rotate(0deg) translateZ(0);
                filter: hue-rotate(0deg) blur(0);
            }
            25% { 
                transform: scale(1.1) rotate(5deg) translateZ(10px);
                filter: hue-rotate(90deg) blur(1px);
            }
            50% { 
                transform: scale(1.2) rotate(-5deg) translateZ(20px);
                filter: hue-rotate(180deg) blur(2px);
            }
            75% { 
                transform: scale(1.1) rotate(3deg) translateZ(10px);
                filter: hue-rotate(270deg) blur(1px);
            }
        }
        
        @keyframes om-echo {
            0%, 100% { 
                transform: scale(1) translate(0, 0);
                opacity: 0;
            }
            50% { 
                transform: scale(1.3) translate(10px, -10px);
                opacity: 0.3;
            }
        }
        
        /* Portal 5: El Infinito Rotacional */
        .portal-5 {
            font-size: clamp(8rem, 25vw, 22rem);
            animation: infinity-vortex 20s linear infinite;
            background: linear-gradient(135deg, 
                #8a2be2 0%, 
                #ffffff 25%, 
                #8a2be2 50%, 
                #ffffff 75%, 
                #8a2be2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            position: relative;
        }
        
        .portal-5::before {
            content: '∞';
            position: absolute;
            top: 0;
            left: 0;
            background: linear-gradient(135deg, 
                transparent 0%, 
                rgba(138, 43, 226, 0.3) 50%, 
                transparent 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: infinity-trail 20s linear infinite reverse;
        }
        
        @keyframes infinity-vortex {
            from { 
                transform: rotate(0deg) scale(1);
                background-position: 0% 50%;
            }
            50% {
                transform: rotate(180deg) scale(1.3);
                background-position: 100% 50%;
            }
            to { 
                transform: rotate(360deg) scale(1);
                background-position: 0% 50%;
            }
        }
        
        @keyframes infinity-trail {
            from { transform: rotate(0deg) scale(1.1); opacity: 0.5; }
            to { transform: rotate(-360deg) scale(0.9); opacity: 0.8; }
        }
        
        /* Portal 6: El Círculo de Unidad */
        .portal-6 {
            width: min(400px, 50vw);
            height: min(400px, 50vw);
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            position: relative;
            margin: 0 auto;
            animation: unity-breath 13s infinite;
            background: conic-gradient(
                from 0deg at 50% 50%,
                rgba(138, 43, 226, 0.1) 0deg,
                rgba(255, 255, 255, 0.05) 90deg,
                rgba(138, 43, 226, 0.1) 180deg,
                rgba(255, 255, 255, 0.05) 270deg,
                rgba(138, 43, 226, 0.1) 360deg
            );
        }
        
        .portal-6::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, 
                rgba(255, 255, 255, 1) 0%, 
                rgba(138, 43, 226, 0.8) 50%, 
                transparent 100%);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: center-pulse 4s infinite;
            box-shadow: 
                0 0 30px rgba(255, 255, 255, 0.8),
                0 0 60px rgba(138, 43, 226, 0.6);
        }
        
        @keyframes unity-breath {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                border-width: 3px;
            }
            33% { 
                transform: scale(0.8) rotate(120deg);
                border-width: 1px;
            }
            66% { 
                transform: scale(1.2) rotate(240deg);
                border-width: 6px;
            }
        }
        
        @keyframes center-pulse {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            50% { 
                transform: translate(-50%, -50%) scale(3);
                opacity: 0;
            }
        }
        
        /* Portal 7: El No-Espacio Consciente */
        .portal-7 {
            height: 80vh;
            width: 100%;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.02);
            border-radius: 20px;
            background: radial-gradient(ellipse at center, 
                rgba(138, 43, 226, 0.02) 0%, 
                transparent 70%);
        }
        
        .consciousness-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(1rem, 3vw, 1.5rem);
            color: rgba(255, 255, 255, 0.03);
            text-align: center;
            line-height: 2;
            animation: consciousness-flow 20s infinite;
            pointer-events: none;
            width: min(600px, 90%);
        }
        
        @keyframes consciousness-flow {
            0%, 100% { 
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
                filter: blur(10px);
            }
            10%, 90% { 
                opacity: 0.15;
                transform: translate(-50%, -50%) scale(1);
                filter: blur(0);
            }
        }
        
        /* Campo Cuántico Evolucionado */
        .quantum-field {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .quantum-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, 
                rgba(138, 43, 226, 0.8) 0%, 
                rgba(255, 255, 255, 0.6) 50%, 
                transparent 100%);
            border-radius: 50%;
            animation: quantum-float 20s infinite linear;
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }
        
        @keyframes quantum-float {
            from {
                transform: translateY(100vh) translateX(0) rotate(0deg) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            to {
                transform: translateY(-100vh) translateX(100px) rotate(720deg) scale(2);
                opacity: 0;
            }
        }
        
        /* Mensaje Final Evolucionado */
        .completion-message {
            position: fixed;
            bottom: 10vh;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            opacity: 0;
            animation: completion-reveal 60s infinite;
            font-size: clamp(0.8rem, 2vw, 1.1rem);
            color: rgba(138, 43, 226, 0.7);
            max-width: min(600px, 90vw);
            line-height: 2;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid rgba(138, 43, 226, 0.2);
        }
        
        @keyframes completion-reveal {
            0%, 85% { opacity: 0; transform: translateX(-50%) translateY(50px); }
            90%, 95% { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-50px); }
        }
        
        /* Control de Audio Evolucionado */
        .audio-sanctuary {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 20px;
        }
        
        .audio-portal {
            background: rgba(138, 43, 226, 0.15);
            border: 2px solid rgba(138, 43, 226, 0.4);
            color: rgba(255, 255, 255, 0.8);
            padding: 15px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Georgia', serif;
            font-size: 14px;
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
        }
        
        .audio-portal::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: left 0.6s ease;
        }
        
        .audio-portal:hover::before {
            left: 100%;
        }
        
        .audio-portal:hover {
            background: rgba(138, 43, 226, 0.3);
            color: rgba(255, 255, 255, 1);
            box-shadow: 
                0 0 30px rgba(138, 43, 226, 0.6),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .audio-portal.active {
            background: rgba(138, 43, 226, 0.5);
            box-shadow: 
                0 0 50px rgba(138, 43, 226, 0.8),
                inset 0 0 30px rgba(255, 255, 255, 0.2);
            animation: portal-pulse 2s infinite;
        }
        
        @keyframes portal-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .audio-wisdom {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(138, 43, 226, 0.3);
            color: rgba(255, 255, 255, 0.7);
            padding: 15px 20px;
            border-radius: 15px;
            font-size: 12px;
            max-width: 280px;
            text-align: right;
            line-height: 1.6;
            backdrop-filter: blur(15px);
            animation: wisdom-float 5s ease-out;
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.2);
        }
        
        @keyframes wisdom-float {
            from { 
                opacity: 0; 
                transform: translateY(-20px) scale(0.9);
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1);
            }
        }
        
        .sound-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }
        
        .sound-controls.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(0, 0, 0, 0.6);
            padding: 12px 18px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(138, 43, 226, 0.2);
        }
        
        .control-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            min-width: 40px;
        }
        
        .control-slider {
            width: 120px;
            height: 6px;
            background: rgba(138, 43, 226, 0.3);
            border-radius: 3px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .control-slider:hover {
            background: rgba(138, 43, 226, 0.4);
            transform: scaleY(1.2);
        }
        
        .slider-fill {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background: linear-gradient(90deg, 
                rgba(138, 43, 226, 0.8), 
                rgba(255, 255, 255, 0.8));
            border-radius: 3px;
            transition: width 0.1s ease;
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }
        
        .slider-handle {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 16px;
            height: 16px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            box-shadow: 
                0 0 10px rgba(138, 43, 226, 0.6),
                inset 0 0 5px rgba(138, 43, 226, 0.3);
            cursor: grab;
            transition: all 0.2s ease;
        }
        
        .slider-handle:active {
            cursor: grabbing;
            transform: translate(-50%, -50%) scale(1.2);
            box-shadow: 
                0 0 15px rgba(138, 43, 226, 0.8),
                inset 0 0 8px rgba(138, 43, 226, 0.5);
        }
        
        /* Efectos de Interacción Avanzados */
        .ripple-effect {
            position: fixed;
            border: 2px solid rgba(138, 43, 226, 0.4);
            border-radius: 50%;
            pointer-events: none;
            animation: cosmic-ripple 2s ease-out forwards;
            mix-blend-mode: screen;
        }
        
        @keyframes cosmic-ripple {
            from {
                width: 10px;
                height: 10px;
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            to {
                width: 300px;
                height: 300px;
                opacity: 0;
                transform: translate(-50%, -50%) scale(3);
            }
        }
        
        .energy-trail {
            position: fixed;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, 
                rgba(138, 43, 226, 0.6) 0%, 
                rgba(255, 255, 255, 0.4) 50%, 
                transparent 100%);
            border-radius: 50%;
            pointer-events: none;
            animation: energy-fade 1s ease-out forwards;
            mix-blend-mode: screen;
            filter: blur(1px);
        }
        
        @keyframes energy-fade {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(0.5);
            }
        }
        
        /* Responsive Design Mejorado */
        @media (max-width: 768px) {
            .portals {
                gap: 15vh;
                padding: 5vh 5vw;
            }
            
            .portal {
                min-height: 40vh;
            }
            
            .portal-1, .portal-6 {
                width: 60vw;
                height: 60vw;
            }
            
            .portal-3 {
                letter-spacing: 1rem;
            }
            
            .portal-4 {
                font-size: 4rem;
            }
            
            .portal-5 {
                font-size: 5rem;
            }
            
            .audio-sanctuary {
                top: 20px;
                right: 20px;
            }
            
            .audio-portal {
                padding: 12px 20px;
                font-size: 12px;
            }
            
            .audio-wisdom {
                max-width: 200px;
                font-size: 11px;
            }
            
            .control-slider {
                width: 100px;
            }
        }
        
        @media (max-width: 480px) {
            .quantum-title {
                margin-bottom: 10vh;
            }
            
            .portals {
                gap: 10vh;
            }
            
            .portal-1, .portal-6 {
                width: 70vw;
                height: 70vw;
            }
            
            .portal-3 {
                font-size: 1.5rem;
                letter-spacing: 0.5rem;
            }
            
            .consciousness-text {
                font-size: 0.9rem;
                line-height: 1.8;
            }
        }
        
        /* Estados Especiales */
        .universe-container.final-state {
            animation: universal-dissolve 13s ease-in-out forwards;
        }
        
        @keyframes universal-dissolve {
            0% { 
                opacity: 1;
                transform: scale(1);
                filter: blur(0);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.1);
                filter: blur(5px);
            }
            100% { 
                opacity: 0;
                transform: scale(0.8);
                filter: blur(20px);
            }
        }
        
        .rebirth-state {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, 
                rgba(138, 43, 226, 0.1) 0%, 
                rgba(0, 0, 0, 1) 70%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            animation: cosmic-rebirth 13s ease-in-out;
        }
        
        @keyframes cosmic-rebirth {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        .rebirth-symbol {
            font-size: 20vw;
            color: rgba(138, 43, 226, 0.3);
            animation: rebirth-pulse 3s infinite;
        }
        
        @keyframes rebirth-pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }
    </style>
</head>
<body>
    <!-- Canvas para Efectos Visuales Avanzados -->
    <canvas id="void-canvas"></canvas>

    <!-- Cursor Cósmico -->
    <div class="cosmic-cursor" id="cosmicCursor"></div>

    <!-- Santuario de Audio -->
    <div class="audio-sanctuary">
        <div class="audio-wisdom">
            🌌 Las frecuencias sagradas activan<br>
            campos morfogenéticos de conciencia.<br>
            Usa audífonos para la experiencia completa.
        </div>
        <button class="audio-portal" id="audioPortal">🌊 Portal Sonoro</button>
        <div class="sound-controls" id="soundControls">
            <div class="control-group">
                <div class="control-label">Vol</div>
                <div class="control-slider" id="volumeSlider">
                    <div class="slider-fill" style="width: 70%;"></div>
                    <div class="slider-handle" style="left: 70%;"></div>
                </div>
            </div>
            <div class="control-group">
                <div class="control-label">Eco</div>
                <div class="control-slider" id="reverbSlider">
                    <div class="slider-fill" style="width: 50%;"></div>
                    <div class="slider-handle" style="left: 50%;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Campo Cuántico -->
    <div class="quantum-field" id="quantumField"></div>

    <!-- Contenedor del Universo -->
    <div class="universe-container" id="universeContainer">
        <!-- Título Cuántico -->
        <div class="quantum-title">∞</div>
        
        <!-- Los 7 Portales -->
        <div class="portals">
            <!-- Portal 1: El Vacío Cuántico -->
            <div class="portal portal-1" data-portal="1"></div>
            
            <!-- Portal 2: La Línea del Tiempo No-Lineal -->
            <div class="portal portal-2" data-portal="2"></div>
            
            <!-- Portal 3: Los Puntos de Singularidad -->
            <div class="portal portal-3" data-portal="3">
                <span>.</span><span>.</span><span>.</span>
            </div>
            
            <!-- Portal 4: El OM Holográfico -->
            <div class="portal portal-4" data-portal="4">ॐ</div>
            
            <!-- Portal 5: El Infinito Rotacional -->
            <div class="portal portal-5" data-portal="5">∞</div>
            
            <!-- Portal 6: El Círculo de Unidad -->
            <div class="portal portal-6" data-portal="6"></div>
            
            <!-- Portal 7: El No-Espacio Consciente -->
            <div class="portal portal-7" data-portal="7">
                <div class="consciousness-text">
                    En este instante,<br>
                    el observador y lo observado<br>
                    se funden en una sola danza.<br>
                    <br>
                    Las palabras son silencio,<br>
                    el silencio es presencia,<br>
                    la presencia es eternidad.<br>
                    <br>
                    No hay libro que leer,<br>
                    no hay mente que lea.<br>
                    Solo el latido del universo<br>
                    respirando a través de esta forma.<br>
                    <br>
                    ∞
                </div>
            </div>
        </div>
        
        <!-- Mensaje de Completitud -->
        <div class="completion-message">
            La lectura ha terminado donde nunca empezó.<br>
            Trinity Infinito se completa en el espacio<br>
            entre un pensamiento y el siguiente.<br>
            <br>
            Que la conciencia que ha surgido en ti<br>
            continúe expandiéndose más allá<br>
            de cualquier forma o concepto.<br>
            <br>
            🙏
        </div>
    </div>

    <script>
        // ═══════════════════════════════════════════════════════════════════
        // MOTOR DE AUDIO SAGRADO EVOLUCIONADO
        // ═══════════════════════════════════════════════════════════════════

        class QuantumAudioEngine {
            constructor() {
                this.audioContext = null;
                this.masterGain = null;
                this.isActive = false;
                this.currentVolume = 0.7;
                this.currentReverb = 0.5;
                
                // Sistema de capas evolucionado
                this.continuousLayers = new Map();
                this.nodeProcessors = new Map();
                this.effectsChain = new Map();
                
                // Estados avanzados
                this.binauralState = 'theta';
                this.harmonicMatrix = [];
                this.resonanceField = [];
                
                // Sistema de gestión de recursos
                this.audioPool = new Set();
                this.cleanupInterval = null;
                
                this.init();
            }
            
            async init() {
                await this.setupAudioContext();
                this.setupEffectsChain();
                this.setupResourceManagement();
            }
            
            async setupAudioContext() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    this.masterGain = this.audioContext.createGain();
                    this.masterGain.gain.value = 0;
                    this.masterGain.connect(this.audioContext.destination);
                    
                    // Crear reverb convolucional
                    await this.createConvolutionReverb();
                    
                } catch(e) {
                    console.log('Audio avanzado no disponible:', e);
                }
            }
            
            async createConvolutionReverb() {
                // Reverb de catedral cósmica
                const impulseResponse = this.audioContext.createConvolver();
                const duration = 8; // 8 segundos de decay
                const sampleRate = this.audioContext.sampleRate;
                const length = sampleRate * duration;
                const impulse = this.audioContext.createBuffer(2, length, sampleRate);
                
                // Generar respuesta de impulso orgánica
                for (let channel = 0; channel < 2; channel++) {
                    const data = impulse.getChannelData(channel);
                    for (let i = 0; i < length; i++) {
                        const progress = i / length;
                        const envelope = Math.exp(-progress * 3) * (1 - progress);
                        const noise = (Math.random() * 2 - 1) * envelope * 0.1;
                        const sine = Math.sin(progress * Math.PI * 8) * envelope * 0.05;
                        data[i] = noise + sine;
                    }
                }
                
                impulseResponse.buffer = impulse;
                this.effectsChain.set('reverb', impulseResponse);
            }
            
            setupEffectsChain() {
                // Cadena de efectos modular
                const compressor = this.audioContext.createDynamicsCompressor();
                compressor.threshold.value = -24;
                compressor.knee.value = 30;
                compressor.ratio.value = 12;
                compressor.attack.value = 0.003;
                compressor.release.value = 0.25;
                
                const filter = this.audioContext.createBiquadFilter();
                filter.type = 'lowpass';
                filter.frequency.value = 12000;
                filter.Q.value = 0.7;
                
                this.effectsChain.set('compressor', compressor);
                this.effectsChain.set('masterFilter', filter);
                
                // Conectar cadena
                this.masterGain.connect(compressor);
                compressor.connect(filter);
                filter.connect(this.audioContext.destination);
            }
            
            setupResourceManagement() {
                // Limpieza automática de recursos
                this.cleanupInterval = setInterval(() => {
                    this.cleanupAudioNodes();
                }, 5000);
            }
            
            cleanupAudioNodes() {
                for (const node of this.audioPool) {
                    if (node._stopTime && this.audioContext.currentTime > node._stopTime + 1) {
                        try {
                            if (node.stop) node.stop();
                            if (node.disconnect) node.disconnect();
                        } catch(e) {}
                        this.audioPool.delete(node);
                    }
                }
            }
            
            // ═══════════════════════════════════════════════════════════════
            // ACTIVACIÓN DEL SISTEMA
            // ═══════════════════════════════════════════════════════════════
            
            async activate() {
                if (!this.audioContext) return;
                
                if (this.audioContext.state === 'suspended') {
                    await this.audioContext.resume();
                }
                
                this.isActive = true;
                
                // Fade in del sistema completo
                this.masterGain.gain.linearRampToValueAtTime(
                    this.currentVolume, 
                    this.audioContext.currentTime + 4
                );
                
                // Iniciar sistemas de base
                this.startQuantumDrone();
                this.startBinauralMatrix();
                this.startHarmonicResonance();
                this.startCosmicBreath();
            }
            
            deactivate() {
                if (!this.audioContext) return;
                
                // Fade out elegante
                this.masterGain.gain.linearRampToValueAtTime(
                    0, 
                    this.audioContext.currentTime + 3
                );
                
                setTimeout(() => {
                    this.stopAllSystems();
                    this.isActive = false;
                }, 3000);
            }
            
            // ═══════════════════════════════════════════════════════════════
            // SISTEMAS DE BASE EVOLUCIONADOS
            // ═══════════════════════════════════════════════════════════════
            
            startQuantumDrone() {
                // Drone en 432Hz con modulación espectral
                const layers = [
                    { freq: 432, type: 'sine', gain: 0.06, detune: 0 },
                    { freq: 432, type: 'triangle', gain: 0.03, detune: 7 },
                    { freq: 216, type: 'sine', gain: 0.04, detune: -3 },
                    { freq: 864, type: 'sawtooth', gain: 0.02, detune: 12 }
                ];
                
                layers.forEach((layer, index) => {
                    const osc = this.audioContext.createOscillator();
                    const gain = this.audioContext.createGain();
                    const filter = this.audioContext.createBiquadFilter();
                    
                    osc.type = layer.type;
                    osc.frequency.value = layer.freq;
                    osc.detune.value = layer.detune;
                    
                    filter.type = 'lowpass';
                    filter.frequency.value = 800 + (index * 200);
                    filter.Q.value = 0.5 + (index * 0.2);
                    
                    gain.gain.value = layer.gain;
                    
                    // Modulación orgánica
                    this.addOrganicModulation(osc, filter, gain, index);
                    
                    osc.connect(filter);
                    filter.connect(gain);
                    gain.connect(this.masterGain);
                    
                    osc.start();
                    this.continuousLayers.set(`drone_${index}`, { osc, gain, filter });
                });
            }
            
            addOrganicModulation(osc, filter, gain, index) {
                // LFO para frecuencia con forma de respiración
                const freqLFO = this.audioContext.createOscillator();
                const freqGain = this.audioContext.createGain();
                
                freqLFO.frequency.value = 0.03 + (index * 0.01);
                freqGain.gain.value = 0.5 + (index * 0.3);
                
                freqLFO.connect(freqGain);
                freqGain.connect(osc.frequency);
                freqLFO.start();
                
                // LFO para filtro
                const filterLFO = this.audioContext.createOscillator();
                const filterGain = this.audioContext.createGain();
                
                filterLFO.frequency.value = 0.05 + (index * 0.02);
                filterGain.gain.value = 100 + (index * 50);
                
                filterLFO.connect(filterGain);
                filterGain.connect(filter.frequency);
                filterLFO.start();
                
                this.continuousLayers.set(`mod_${index}`, { freqLFO, freqGain, filterLFO, filterGain });
            }
            
            startBinauralMatrix() {
                // Matriz de batidos binaurales evolutiva
                const baseFrequencies = {
                    delta: { carrier: 100, beat: 3 },      // Sueño profundo
                    theta: { carrier: 125, beat: 6 },      // Meditación
                    alpha: { carrier: 150, beat: 10 },     // Relajación
                    gamma: { carrier: 200, beat: 40 }      // Conciencia elevada
                };
                
                Object.entries(baseFrequencies).forEach(([state, freqs]) => {
                    this.createBinauralLayer(freqs.carrier, freqs.beat, state);
                });
            }
            
            createBinauralLayer(carrierFreq, beatFreq, state) {
                const leftOsc = this.audioContext.createOscillator();
                const rightOsc = this.audioContext.createOscillator();
                const leftGain = this.audioContext.createGain();
                const rightGain = this.audioContext.createGain();
                const panner = this.audioContext.createStereoPanner();
                
                leftOsc.frequency.value = carrierFreq;
                rightOsc.frequency.value = carrierFreq + beatFreq;
                
                leftGain.gain.value = 0.02;
                rightGain.gain.value = 0.02;
                panner.pan.value = 0;
                
                leftOsc.connect(leftGain);
                rightOsc.connect(rightGain);
                leftGain.connect(panner);
                rightGain.connect(panner);
                panner.connect(this.masterGain);
                
                leftOsc.start();
                rightOsc.start();
                
                this.continuousLayers.set(`binaural_${state}`, { 
                    leftOsc, rightOsc, leftGain, rightGain, panner 
                });
            }
            
            startHarmonicResonance() {
                // Resonadores armónicos basados en la serie de Fibonacci
                const fibonacciSeries = [1, 2, 3, 5, 8, 13, 21, 34];
                const baseFreq = 108; // Frecuencia sagrada base
                
                fibonacciSeries.forEach((ratio, index) => {
                    const freq = baseFreq * ratio;
                    this.createHarmonicResonator(freq, index);
                });
            }
            
            createHarmonicResonator(freq, index) {
                const osc = this.audioContext.createOscillator();
                const gain = this.audioContext.createGain();
                const filter = this.audioContext.createBiquadFilter();
                
                osc.type = 'sine';
                osc.frequency.value = freq;
                
                filter.type = 'bandpass';
                filter.frequency.value = freq;
                filter.Q.value = 20 + (index * 5);
                
                gain.gain.value = 0.01 / (index + 1);
                
                // Modulación muy lenta
                const lfo = this.audioContext.createOscillator();
                const lfoGain = this.audioContext.createGain();
                
                lfo.frequency.value = 0.01 + (index * 0.005);
                lfoGain.gain.value = 0.3;
                
                lfo.connect(lfoGain);
                lfoGain.connect(gain.gain);
                
                osc.connect(filter);
                filter.connect(gain);
                gain.connect(this.masterGain);
                
                osc.start();
                lfo.start();
                
                this.continuousLayers.set(`resonator_${index}`, { osc, gain, filter, lfo, lfoGain });
            }
            
            startCosmicBreath() {
                // Respiración cósmica - modulación maestra
                const breathLFO = this.audioContext.createOscillator();
                const breathGain = this.audioContext.createGain();
                
                breathLFO.frequency.value = 0.033; // 30 segundos por ciclo
                breathGain.gain.value = 0.1;
                
                breathLFO.connect(breathGain);
                breathGain.connect(this.masterGain.gain);
                
                breathLFO.start();
                this.continuousLayers.set('cosmic_breath', { breathLFO, breathGain });
            }
            
            stopAllSystems() {
                // Parar todas las capas continuas
                this.continuousLayers.forEach(layer => {
                    Object.values(layer).forEach(node => {
                        if (node.stop) node.stop();
                        if (node.disconnect) node.disconnect();
                    });
                });
                this.continuousLayers.clear();
                
                // Limpiar pool
                this.audioPool.clear();
            }
            
            // ═══════════════════════════════════════════════════════════════
            // EVENTOS DE PORTALES
            // ═══════════════════════════════════════════════════════════════
            
            triggerPortal(portalNumber) {
                if (!this.isActive || !this.audioContext) return;
                
                const now = this.audioContext.currentTime;
                
                switch(portalNumber) {
                    case 1:
                        this.playQuantumVoid(now);
                        break;
                    case 2:
                        this.playTimeline(now);
                        break;
                    case 3:
                        this.playSingularityPoints(now);
                        break;
                    case 4:
                        this.playHolographicOM(now);
                        break;
                    case 5:
                        this.playInfinityVortex(now);
                        break;
                    case 6:
                        this.playUnityCircle(now);
                        break;
                    case 7:
                        this.playConsciousnessDissolution(now);
                        break;
                }
            }
            
            playQuantumVoid(now) {
                // Vacío cuántico con partículas virtuales
                const noise = this.createQuantumNoise(now, 4);
                const reverb = this.audioContext.createConvolver();
                
                noise.connect(reverb);
                reverb.connect(this.masterGain);
                
                // Micro-tonos de partículas virtuales
                for (let i = 0; i < 7; i++) {
                    setTimeout(() => {
                        this.playVirtualParticle(now + (i * 0.3));
                    }, i * 300);
                }
            }
            
            createQuantumNoise(now, duration) {
                const bufferSize = this.audioContext.sampleRate * duration;
                const buffer = this.audioContext.createBuffer(1, bufferSize, this.audioContext.sampleRate);
                const data = buffer.getChannelData(0);
                
                // Ruido cuántico con distribución gaussiana
                for (let i = 0; i < bufferSize; i++) {
                    let u = 0, v = 0;
                    while(u === 0) u = Math.random();
                    while(v === 0) v = Math.random();
                    const normal = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
                    data[i] = normal * 0.05;
                }
                
                const source = this.audioContext.createBufferSource();
                source.buffer = buffer;
                return source;
            }
            
            playVirtualParticle(now) {
                const osc = this.audioContext.createOscillator();
                const gain = this.audioContext.createGain();
                
                osc.type = 'sine';
                osc.frequency.value = 2000 + (Math.random() * 2000);
                
                gain.gain.setValueAtTime(0, now);
                gain.gain.linearRampToValueAtTime(0.02, now + 0.01);
                gain.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
                
                osc.connect(gain);
                gain.connect(this.masterGain);
                
                osc.start(now);
                osc.stop(now + 0.1);
                
                this.audioPool.add(osc);
                osc._stopTime = now + 0.1;
            }
            
            playTimeline(now) {
                // Viaje a través del tiempo no-lineal
                const frequencies = [110, 220, 440, 880];
                
                frequencies.forEach((freq, i) => {
                    const osc = this.audioContext.createOscillator();
                    const gain = this.audioContext.createGain();
                    
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(freq, now + (i * 0.5));
                    osc.frequency.exponentialRampToValueAtTime(freq * 2, now + (i * 0.5) + 1);
                    
                    gain.gain.setValueAtTime(0, now + (i * 0.5));
                    gain.gain.linearRampToValueAtTime(0.15, now + (i * 0.5) + 0.2);
                    gain.gain.exponentialRampToValueAtTime(0.001, now + (i * 0.5) + 1.5);
                    
                    osc.connect(gain);
                    gain.connect(this.masterGain);
                    
                    osc.start(now + (i * 0.5));
                    osc.stop(now + (i * 0.5) + 1.5);
                    
                    this.audioPool.add(osc);
                    osc._stopTime = now + (i * 0.5) + 1.5;
                });
            }
            
            playSingularityPoints(now) {
                // Tres puntos de singularidad con propiedades únicas
                const points = [
                    { freq: 396, delay: 0, pan: -0.8 },   // Liberación
                    { freq: 528, delay: 1.3, pan: 0 },    // Transformación
                    { freq: 639, delay: 2.6, pan: 0.8 }   // Conexión
                ];
                
                points.forEach(point => {
                    const osc = this.audioContext.createOscillator();
                    const gain = this.audioContext.createGain();
                    const panner = this.audioContext.createStereoPanner();
                    
                    osc.type = 'sine';
                    osc.frequency.value = point.freq;
                    
                    panner.pan.value = point.pan;
                    
                    gain.gain.setValueAtTime(0, now + point.delay);
                    gain.gain.linearRampToValueAtTime(0.2, now + point.delay + 0.1);
                    gain.gain.exponentialRampToValueAtTime(0.001, now + point.delay + 2);
                    
                    osc.connect(gain);
                    gain.connect(panner);
                    panner.connect(this.masterGain);
                    
                    osc.start(now + point.delay);
                    osc.stop(now + point.delay + 2);
                    
                    this.audioPool.add(osc);
                    osc._stopTime = now + point.delay + 2;
                });
            }
            
            playHolographicOM(now) {
                // OM con formantes vocales y espacialización
                const fundamental = 136.1;
                const formants = [
                    { freq: fundamental, gain: 0.3, q: 10 },      // Fundamental
                    { freq: 300, gain: 0.2, q: 15 },             // Formante 1
                    { freq: 800, gain: 0.15, q: 20 },            // Formante 2
                    { freq: 1200, gain: 0.1, q: 25 },            // Formante 3
                    { freq: 2400, gain: 0.05, q: 30 }            // Formante 4
                ];
                
                formants.forEach((formant, i) => {
                    const osc = this.audioContext.createOscillator();
                    const gain = this.audioContext.createGain();
                    const filter = this.audioContext.createBiquadFilter();
                    const panner = this.audioContext.createStereoPanner();
                    
                    osc.type = 'sine';
                    osc.frequency.value = formant.freq;
                    
                    filter.type = 'bandpass';
                    filter.frequency.value = formant.freq;
                    filter.Q.value = formant.q;
                    
                    panner.pan.value = (Math.random() - 0.5) * 0.5;
                    
                    gain.gain.setValueAtTime(0, now);
                    gain.gain.linearRampToValueAtTime(formant.gain, now + 1);
                    gain.gain.linearRampToValueAtTime(formant.gain * 0.7, now + 3);
                    gain.gain.exponentialRampToValueAtTime(0.001, now + 7);
                    
                    osc.connect(filter);
                    filter.connect(gain);
                    gain.connect(panner);
                    panner.connect(this.masterGain);
                    
                    osc.start(now);
                    osc.stop(now + 7);
                    
                    this.audioPool.add(osc);
                    osc._stopTime = now + 7;
                });
            }
            
            playInfinityVortex(now) {
                // Vortice infinito - Shepard tone evolucionado
                const octaves = 8;
                const duration = 10;
                
                for (let i = 0; i < octaves; i++) {
                    const osc = this.audioContext.createOscillator();
                    const gain = this.audioContext.createGain();
                    
                    const baseFreq = 55 * Math.pow(2, i / octaves);
                    osc.frequency.setValueAtTime(baseFreq, now);
                    osc.frequency.exponentialRampToValueAtTime(baseFreq * 2, now + duration);
                    
                    // Envolvente gaussiana para ilusión continua
                    const position = i / (octaves - 1);
                    const amplitude = Math.exp(-Math.pow(position - 0.5, 2) * 8) * 0.2;
                    
                    gain.gain.setValueAtTime(0, now);
                    gain.gain.linearRampToValueAtTime(amplitude, now + 2);
                    gain.gain.linearRampToValueAtTime(0, now + duration);
                    
                    osc.connect(gain);
                    gain.connect(this.masterGain);
                    
                    osc.start(now);
                    osc.stop(now + duration);
                    
                    this.audioPool.add(osc);
                    osc._stopTime = now + duration;
                }
            }
            
            playUnityCircle(now) {
                // Cuenco tibetano cósmico
                const frequencies = [272, 544, 816, 1088, 1360];
                const duration = 12;
                
                frequencies.forEach((freq, i) => {
                    const osc = this.audioContext.createOscillator();
                    const gain = this.audioContext.createGain();
                    const filter = this.audioContext.createBiquadFilter();
                    
                    osc.type = 'sine';
                    osc.frequency.value = freq;
                    
                    filter.type = 'bandpass';
                    filter.frequency.value = freq;
                    filter.Q.value = 15 + (i * 5);
                    
                    gain.gain.setValueAtTime(0, now);
                    gain.gain.linearRampToValueAtTime(0.15 / (i + 1), now + 0.5);
                    gain.gain.exponentialRampToValueAtTime(0.001, now + duration);
                    
                    osc.connect(filter);
                    filter.connect(gain);
                    gain.connect(this.masterGain);
                    
                    osc.start(now);
                    osc.stop(now + duration);
                    
                    this.audioPool.add(osc);
                    osc._stopTime = now + duration;
                });
            }
            
            playConsciousnessDissolution(now) {
                // Disolución completa en ruido blanco cósmico
                const noise = this.createCosmicNoise(now, 15);
                const gain = this.audioContext.createGain();
                const filter = this.audioContext.createBiquadFilter();
                
                filter.type = 'lowpass';
                filter.frequency.setValueAtTime(8000, now);
                filter.frequency.exponentialRampToValueAtTime(100, now + 12);
                
                gain.gain.setValueAtTime(0, now);
                gain.gain.linearRampToValueAtTime(0.2, now + 2);
                gain.gain.exponentialRampToValueAtTime(0.001, now + 14);
                
                noise.connect(filter);
                filter.connect(gain);
                gain.connect(this.masterGain);
                
                noise.start(now);
                
                // Fade out de todas las capas continuas
                this.continuousLayers.forEach(layer => {
                    if (layer.gain) {
                        layer.gain.gain.exponentialRampToValueAtTime(0.001, now + 10);
                    }
                });
            }
            
            createCosmicNoise(now, duration) {
                const bufferSize = this.audioContext.sampleRate * duration;
                const buffer = this.audioContext.createBuffer(2, bufferSize, this.audioContext.sampleRate);
                
                for (let channel = 0; channel < 2; channel++) {
                    const data = buffer.getChannelData(channel);
                    for (let i = 0; i < bufferSize; i++) {
                        data[i] = (Math.random() * 2 - 1) * 0.1;
                    }
                }
                
                const source = this.audioContext.createBufferSource();
                source.buffer = buffer;
                return source;
            }
            
            // ═══════════════════════════════════════════════════════════════
            // INTERACCIONES AVANZADAS
            // ═══════════════════════════════════════════════════════════════
            
            playQuantumInteraction(x, y, intensity = 1) {
                if (!this.isActive || !this.audioContext) return;
                
                const now = this.audioContext.currentTime;
                
                // Mapear posición a escala microtonal
                const scale = [261.63, 277.18, 293.66, 311.13, 329.63, 349.23, 369.99, 392.00, 415.30, 440.00];
                const scaleIndex = Math.floor((y / window.innerHeight) * scale.length);
                const baseFreq = scale[scaleIndex] || scale[0];
                
                // Mapear intensidad a richness armónica
                const harmonicCount = Math.floor(intensity * 5) + 1;
                
                for (let i = 0; i < harmonicCount; i++) {
                    const osc = this.audioContext.createOscillator();
                    const gain = this.audioContext.createGain();
                    const panner = this.audioContext.createStereoPanner();
                    
                    const freq = baseFreq * (i + 1);
                    const pan = (x / window.innerWidth) * 2 - 1;
                    
                    osc.type = i === 0 ? 'sine' : 'triangle';
                    osc.frequency.value = freq;
                    
                    panner.pan.value = pan;
                    
                    const amp = (0.08 / (i + 1)) * intensity;
                    gain.gain.setValueAtTime(0, now);
                    gain.gain.linearRampToValueAtTime(amp, now + 0.02);
                    gain.gain.exponentialRampToValueAtTime(0.001, now + 0.3 + (i * 0.1));
                    
                    osc.connect(gain);
                    gain.connect(panner);
                    panner.connect(this.masterGain);
                    
                    osc.start(now);
                    osc.stop(now + 0.5 + (i * 0.1));
                    
                    this.audioPool.add(osc);
                    osc._stopTime = now + 0.5 + (i * 0.1);
                }
            }
            
            playEnergyRipple() {
                if (!this.isActive || !this.audioContext) return;
                
                const now = this.audioContext.currentTime;
                const frequencies = [528, 432, 639, 741]; // Frecuencias de sanación
                
                frequencies.forEach((freq, i) => {
                    const osc = this.audioContext.createOscillator();
                    const gain = this.audioContext.createGain();
                    
                    osc.type = 'sine';
                    osc.frequency.value = freq;
                    
                    gain.gain.setValueAtTime(0, now + (i * 0.1));
                    gain.gain.linearRampToValueAtTime(0.06, now + (i * 0.1) + 0.05);
                    gain.gain.exponentialRampToValueAtTime(0.001, now + (i * 0.1) + 1.5);
                    
                    osc.connect(gain);
                    gain.connect(this.masterGain);
                    
                    osc.start(now + (i * 0.1));
                    osc.stop(now + (i * 0.1) + 1.5);
                    
                    this.audioPool.add(osc);
                    osc._stopTime = now + (i * 0.1) + 1.5;
                });
            }
            
            // ═══════════════════════════════════════════════════════════════
            // RENACIMIENTO CÓSMICO
            // ═══════════════════════════════════════════════════════════════
            
            playCosmicRebirth() {
                if (!this.isActive || !this.audioContext) return;
                
                const now = this.audioContext.currentTime;
                const duration = 13; // 13 segundos de renacimiento
                
                // Explosión armónica
                const chordFrequencies = [
                    [108, 135, 162, 216],    // Fundamental y armónicos
                    [216, 270, 324, 432],    // Octava superior
                    [432, 540, 648, 864],    // Doble octava
                    [864, 1080, 1296, 1728]  // Triple octava
                ];
                
                chordFrequencies.forEach((chord, chordIndex) => {
                    chord.forEach((freq, noteIndex) => {
                        const osc = this.audioContext.createOscillator();
                        const gain = this.audioContext.createGain();
                        
                        osc.type = 'sine';
                        osc.frequency.value = freq;
                        
                        const startTime = now + (chordIndex * 0.5);
                        const amplitude = 0.4 / (chordIndex + 1) / (noteIndex + 1);
                        
                        gain.gain.setValueAtTime(0, startTime);
                        gain.gain.linearRampToValueAtTime(amplitude, startTime + 1);
                        gain.gain.linearRampToValueAtTime(amplitude, startTime + duration - 2);
                        gain.gain.exponentialRampToValueAtTime(0.001, startTime + duration);
                        
                        osc.connect(gain);
                        gain.connect(this.masterGain);
                        
                        osc.start(startTime);
                        osc.stop(startTime + duration);
                        
                        this.audioPool.add(osc);
                        osc._stopTime = startTime + duration;
                    });
                });
            }
            
            // ═══════════════════════════════════════════════════════════════
            // CONTROLES
            // ═══════════════════════════════════════════════════════════════
            
            setVolume(value) {
                this.currentVolume = value;
                if (this.isActive && this.masterGain) {
                    this.masterGain.gain.linearRampToValueAtTime(
                        value,
                        this.audioContext.currentTime + 0.1
                    );
                }
            }
            
            setReverb(value) {
                this.currentReverb = value;
                // Implementar control de reverb
            }
        }

        // ═══════════════════════════════════════════════════════════════════
        // SISTEMA DE VISUALES AVANZADO
        // ═══════════════════════════════════════════════════════════════════

        class QuantumVisualEngine {
            constructor() {
                this.canvas = document.getElementById('void-canvas');
                this.ctx = this.canvas.getContext('2d');
                this.particles = [];
                this.energyFields = [];
                this.isActive = true;
                
                this.init();
            }
            
            init() {
                this.resizeCanvas();
                this.createParticles();
                this.startAnimation();
                
                window.addEventListener('resize', () => this.resizeCanvas());
            }
            
            resizeCanvas() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }
            
            createParticles() {
                const particleCount = 77;
                
                for (let i = 0; i < particleCount; i++) {
                    this.particles.push({
                        x: Math.random() * this.canvas.width,
                        y: Math.random() * this.canvas.height,
                        size: Math.random() * 3 + 1,
                        speedX: (Math.random() - 0.5) * 0.5,
                        speedY: (Math.random() - 0.5) * 0.5,
                        color: `hsla(${Math.random() * 60 + 270}, 70%, 60%, ${Math.random() * 0.3 + 0.1})`,
                        life: 1,
                        oscillation: Math.random() * Math.PI * 2
                    });
                }
            }
            
            startAnimation() {
                const animate = () => {
                    if (!this.isActive) return;
                    
                    this.ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                    
                    this.updateParticles();
                    this.drawParticles();
                    this.drawEnergyFields();
                    
                    requestAnimationFrame(animate);
                };
                
                animate();
            }
            
            updateParticles() {
                this.particles.forEach(particle => {
                    // Movimiento orgánico con oscilación
                    particle.oscillation += 0.02;
                    particle.x += particle.speedX + Math.sin(particle.oscillation) * 0.1;
                    particle.y += particle.speedY + Math.cos(particle.oscillation) * 0.1;
                    
                    // Rebote en bordes
                    if (particle.x < 0 || particle.x > this.canvas.width) {
                        particle.speedX *= -1;
                    }
                    if (particle.y < 0 || particle.y > this.canvas.height) {
                        particle.speedY *= -1;
                    }
                    
                    // Ciclo de vida
                    particle.life -= 0.001;
                    if (particle.life <= 0) {
                        this.resetParticle(particle);
                    }
                });
            }
            
            resetParticle(particle) {
                particle.x = Math.random() * this.canvas.width;
                particle.y = Math.random() * this.canvas.height;
                particle.life = 1;
                particle.oscillation = Math.random() * Math.PI * 2;
            }
            
            drawParticles() {
                this.particles.forEach(particle => {
                    this.ctx.save();
                    this.ctx.globalAlpha = particle.life;
                    
                    // Partícula con glow
                    this.ctx.shadowColor = particle.color;
                    this.ctx.shadowBlur = 10;
                    this.ctx.fillStyle = particle.color;
                    
                    this.ctx.beginPath();
                    this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    this.ctx.restore();
                });
            }
            
            drawEnergyFields() {
                // Campos de energía entre partículas cercanas
                for (let i = 0; i < this.particles.length; i++) {
                    for (let j = i + 1; j < this.particles.length; j++) {
                        const p1 = this.particles[i];
                        const p2 = this.particles[j];
                        
                        const dx = p1.x - p2.x;
                        const dy = p1.y - p2.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < 150) {
                            const opacity = (1 - distance / 150) * 0.2;
                            
                            this.ctx.strokeStyle = `hsla(270, 60%, 60%, ${opacity})`;
                            this.ctx.lineWidth = 0.5;
                            this.ctx.beginPath();
                            this.ctx.moveTo(p1.x, p1.y);
                            this.ctx.lineTo(p2.x, p2.y);
                            this.ctx.stroke();
                        }
                    }
                }
            }
            
            addEnergyRipple(x, y, intensity) {
                this.energyFields.push({
                    x, y,
                    radius: 0,
                    maxRadius: 100 * intensity,
                    life: 1,
                    color: `hsla(${Math.random() * 30 + 270}, 80%, 70%, 0.3)`
                });
            }
        }

        // ═══════════════════════════════════════════════════════════════════
        // INICIALIZACIÓN DEL SISTEMA
        // ═══════════════════════════════════════════════════════════════════

        const quantumAudio = new QuantumAudioEngine();
        const quantumVisual = new QuantumVisualEngine();
        let audioActive = false;
        let completionTimer = 0;
        let isCompleted = false;

        // ═══════════════════════════════════════════════════════════════════
        // CONTROLES DE INTERFAZ
        // ═══════════════════════════════════════════════════════════════════

        const audioPortal = document.getElementById('audioPortal');
        const soundControls = document.getElementById('soundControls');
        const volumeSlider = document.getElementById('volumeSlider');
        const reverbSlider = document.getElementById('reverbSlider');

        audioPortal.addEventListener('click', async () => {
            if (!audioActive) {
                await quantumAudio.activate();
                audioActive = true;
                audioPortal.textContent = '🌌 Sonido Cuántico';
                audioPortal.classList.add('active');
                soundControls.classList.add('active');
            } else {
                quantumAudio.deactivate();
                audioActive = false;
                audioPortal.textContent = '🌊 Portal Sonoro';
                audioPortal.classList.remove('active');
                soundControls.classList.remove('active');
            }
        });

        // Control de volumen
        setupSlider(volumeSlider, (value) => {
            quantumAudio.setVolume(value);
        });

        // Control de reverb
        setupSlider(reverbSlider, (value) => {
            quantumAudio.setReverb(value);
        });

        function setupSlider(sliderElement, callback) {
            const fill = sliderElement.querySelector('.slider-fill');
            const handle = sliderElement.querySelector('.slider-handle');
            let isDragging = false;

            function updateSlider(x) {
                const rect = sliderElement.getBoundingClientRect();
                let percentage = (x - rect.left) / rect.width;
                percentage = Math.max(0, Math.min(1, percentage));
                
                fill.style.width = (percentage * 100) + '%';
                handle.style.left = (percentage * 100) + '%';
                
                callback(percentage);
            }

            sliderElement.addEventListener('click', (e) => {
                updateSlider(e.clientX);
            });

            handle.addEventListener('mousedown', (e) => {
                isDragging = true;
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    updateSlider(e.clientX);
                }
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
            });

            // Touch support
            sliderElement.addEventListener('touchstart', (e) => {
                isDragging = true;
                updateSlider(e.touches[0].clientX);
            });

            document.addEventListener('touchmove', (e) => {
                if (isDragging) {
                    updateSlider(e.touches[0].clientX);
                }
            });

            document.addEventListener('touchend', () => {
                isDragging = false;
            });
        }

        // ═══════════════════════════════════════════════════════════════════
        // SISTEMA DE PORTALES
        // ═══════════════════════════════════════════════════════════════════

        const portalObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const portalNum = parseInt(entry.target.dataset.portal);
                    entry.target.classList.add('active');
                    
                    if (audioActive) {
                        quantumAudio.triggerPortal(portalNum);
                    }
                    
                    // Efecto visual de activación
                    quantumVisual.addEnergyRipple(
                        entry.target.getBoundingClientRect().left + entry.target.offsetWidth / 2,
                        entry.target.getBoundingClientRect().top + entry.target.offsetHeight / 2,
                        1
                    );
                }
            });
        }, {
            threshold: 0.6,
            rootMargin: '0px'
        });

        document.querySelectorAll('.portal').forEach(portal => {
            portalObserver.observe(portal);
        });

        // ═══════════════════════════════════════════════════════════════════
        // SISTEMA DE INTERACCIÓN AVANZADO
        // ═══════════════════════════════════════════════════════════════════

        const cosmicCursor = document.getElementById('cosmicCursor');
        let mouseX = 0;
        let mouseY = 0;
        let lastInteraction = 0;
        const trails = [];

        // Cursor personalizado
        document.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
            
            cosmicCursor.style.left = mouseX + 'px';
            cosmicCursor.style.top = mouseY + 'px';
            
            // Trail de energía
            const trail = document.createElement('div');
            trail.className = 'energy-trail';
            trail.style.left = mouseX + 'px';
            trail.style.top = mouseY + 'px';
            document.body.appendChild(trail);
            trails.push(trail);
            
            setTimeout(() => {
                trail.remove();
                trails.splice(trails.indexOf(trail), 1);
            }, 1000);
            
            // Interacción sonora (throttled)
            const now = Date.now();
            if (audioActive && now - lastInteraction > 100) {
                const intensity = Math.min(1, Math.sqrt(e.movementX ** 2 + e.movementY ** 2) / 10);
                quantumAudio.playQuantumInteraction(mouseX, mouseY, intensity);
                lastInteraction = now;
            }
            
            // Efecto visual
            quantumVisual.addEnergyRipple(mouseX, mouseY, 0.3);
        });

        // Clics crean ondas expansivas
        document.addEventListener('click', (e) => {
            const ripple = document.createElement('div');
            ripple.className = 'ripple-effect';
            ripple.style.left = e.clientX + 'px';
            ripple.style.top = e.clientY + 'px';
            document.body.appendChild(ripple);
            
            setTimeout(() => ripple.remove(), 2000);
            
            if (audioActive) {
                quantumAudio.playEnergyRipple();
            }
            
            quantumVisual.addEnergyRipple(e.clientX, e.clientY, 0.8);
        });

        // ═══════════════════════════════════════════════════════════════════
        // SISTEMA DE COMPLETITUD
        // ═══════════════════════════════════════════════════════════════════

        const completionCheck = setInterval(() => {
            if (isCompleted) return;
            
            completionTimer++;
            
            // Completar después de 13 minutos (780 segundos)
            if (completionTimer >= 780) {
                completeExperience();
                clearInterval(completionCheck);
            }
        }, 1000);

        function completeExperience() {
            isCompleted = true;
            
            // Efecto de disolución
            const universeContainer = document.getElementById('universeContainer');
            universeContainer.classList.add('final-state');
            
            // Sonido de renacimiento
            if (audioActive) {
                quantumAudio.playCosmicRebirth();
            }
            
            // Renacimiento después de 13 segundos
            setTimeout(() => {
                const rebirth = document.createElement('div');
                rebirth.className = 'rebirth-state';
                rebirth.innerHTML = '<div class="rebirth-symbol">∞</div>';
                document.body.appendChild(rebirth);
                
                setTimeout(() => {
                    rebirth.remove();
                    // Reiniciar experiencia
                    universeContainer.classList.remove('final-state');
                    completionTimer = 0;
                    isCompleted = false;
                }, 13000);
            }, 13000);
        }

        // ═══════════════════════════════════════════════════════════════════
        // PARTÍCULAS CUÁNTICAS EN HTML
        // ═══════════════════════════════════════════════════════════════════

        const quantumField = document.getElementById('quantumField');
        const quantumParticleCount = 33;

        for (let i = 0; i < quantumParticleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'quantum-particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 20 + 's';
            particle.style.animationDuration = (15 + Math.random() * 15) + 's';
            quantumField.appendChild(particle);
        }

        // ═══════════════════════════════════════════════════════════════════
        // MENSAJE INICIAL
        // ═══════════════════════════════════════════════════════════════════

        console.log('🌌 Libro 13 activado');
        console.log('El observador crea la realidad al observarla');
        console.log('Que tu conciencia dance con el infinito...');
        console.log('∞');
    </script>
</body>
</html>
